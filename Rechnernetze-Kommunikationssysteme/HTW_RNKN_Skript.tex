\newcommand{\customDir}{../}
\input{\customDir _LaTeX_master/LaTeX_master_setup.sty}

%\setboolean{twosided}{true}
%\setCustomDocumentClass{scrartcl}
%\setCustomDesign{htw}
\setCustomSlidePath{Vorlesung/rn-}
\setCustomSlideScale{1}

\setCustomTitle{\texorpdfstring{Rechnernetze /\\ Kommunikationssysteme}{Rechnernetze / Kommunikationssysteme}}
\setCustomSubtitle{Vorlesungsskript}
\setCustomAuthor{Falk-Jonatan Strube}
%\setCustomNoteA{TitlepageNoteBeforeAuthor}
\setCustomNoteB{Vorlesung von }

%\setcustomSignature{\footnotesize{\textcolor{darkgray}{Mitschrift von\\ \customAuthor}}	% Formatierung der Signatur in der Fußzeile
%\setcustomTitleAuthor{\textcolor{darkgray}{Mitschrift von #1}}	% Formatierung des Autors auf dem Titelblatt

\input{\customDir _LaTeX_master/LaTeX_master.sty}
\input{\customDir _LaTeX_master/LaTeX_master_macros.sty}

%\bibliography{\customDir _Literatur/HTW_Literatur.bib}
\setlength{\headheight}{10mm}	% default: ca. 8mm

\begin{document}

%\selectlanguage{english}
\maketitle
\newpage
\tableofcontents
\newpage

\chapter*{Vorbemerkung}

% User: rn PW: VLRN
Zur Prüfung: alles erlaubt (Taschenrechner, Unterlagen, …)

\chapter{Einführung}

% Folien

\section{Moderne Kommunikation}
Bandbreite: zur Zeit noch beschränkt, denkbar auch, dass jeder auf allen Bandbreiten. WLAN und Bluetooth sind schon auf einer Bandbreite und bekommen es auch hin.\\
Sendeleistung: Nicht „zu laut reden“, damit sich andere auch noch verstehen.

\chapter{Sockets}

\section{Einführung}
\subsection{Schnittstelle auf einem Host zur Datenübertragung an andere Prozesse}
\slides{10-sockets_print}{3}
\subsection{Socketschnittstelle: Abgrenzung}
\slides{10-sockets_print}{4}
\subsection{IP-Adressen und Ports}
\slides{10-sockets_print}{5}
\section{Demultiplexing}
\slides{10-sockets_print}{6}
\subsection{Verbindungsloses Demultiplexing (UDP)}
\slides{10-sockets_print}{7}
\paragraph{Testfrage:} Benötigte UDP-Sockets: 2 Sockets (beliebig viele Partner können auf einen Port/Socket kommen, dafür muss darauf geachtet werden, dass das Paket an den richtigen Absender zurück geschickt wird)
\subsection{Verbindungsorientiertes Demultiplexing (TCP)}
\slides{10-sockets_print}{8}
\paragraph{Testfrage:} Benötigte TCP-Sockets: 3 Sockets (jeder Verbindung ist eigenständig und vom Rechner verwaltet, es muss sich nicht drum gekümmert werden, dass es auch an den richtigen Partner zurück geschickt wird)
\slides{10-sockets_print}{9}
\section{Socket-Programmierung}
\slides{10-sockets_print}{10}
\subsection{UDP-Sockets}
\slides{10-sockets_print}{11}
\slides{10-sockets_print}{12}
\subsubsection{UDP-Demo Datenströme}
Datenströme müssen explizit in Pakete gewandelt werden:\\
UDP ist kein Stream $\to$ Konvertierung IO-Stream $\Leftrightarrow$ UDP.
\slides{10-sockets_print}{13}
\subsubsection{UDP-Demo Client}
\slides{10-sockets_print}{14}
\slides{10-sockets_print}{15}
Achtung: Wenn Paket verloren geht, würde Programm stehen bleiben! Dafür gibt es in der Funktion \emph{.recieve()} auch die Option eines Timeouts.\\
Hinweis nebenbei: sendData-Array hätte gar nicht initialisiert werden müssen, weil er in der Zuweisung später sowieso einen neuen Zeiger bekommt.
\subsubsection{UDP-Demo Server}
\slides{10-sockets_print}{16}
\slides{10-sockets_print}{17}
\slides{10-sockets_print}{18}
UDP vor allem bei Anfragen sinnvoll, die in ein Paket passen. Nicht so sinnvoll für mehrere Pakete/Streams.

\subsection{TCP-Sockets}
\slides{10-sockets_print}{19}
\slides{10-sockets_print}{20}
\slides{10-sockets_print}{21}
\subsubsection*{Dreiwege-Handshake}
\slides{10-sockets_print}{22}
\slides{10-sockets_print}{23}
\subsubsection{TCP-Demo Datenströme}
Eingabestrom: Quelle - Tastatur\\
Ausgabestrom: Senke - Socket
\slides{10-sockets_print}{24}
\slides{10-sockets_print}{25}
\subsubsection{TCP-Demo Client}
\slides{10-sockets_print}{26}
\slides{10-sockets_print}{27}
\subsubsection{TCP-Demo Server}
\slides{10-sockets_print}{28}
\slides{10-sockets_print}{29}

\section{Werkzeug Netcat}
\slides{10-sockets_print}{30}

\section*{Zusammenfassung}
\slides{10-sockets_print}{31}

\chapter{Grundlagen OSI}

\section{Verzögerung}

\subsection{Verzögerung in paketorientierten Netzen}
\slides{12-grundlagen_print}{3}

\subsubsection*{Beispiele}
\slides{12-grundlagen_print}{4}

\subsubsection*{Grafik Verzögerung}
\slides{12-grundlagen_print}{5}
(Hinweis: Interessant für Prüfung)

\subsubsection{Datenrate-Verzögerungsprodukt}
bandwitdh-delay product, BDP (Begriff Bandbreite hier korrekt)
\slides{12-grundlagen_print}{6}
Wichtig: Es gibt einen Unterschied zwischen dem physischen Durchsatz und dem, der tatsächlich nur ankommt. In diesem Fall ist der Unterschied sehr groß: da muss die Fenstergröße größer gewählt werden.

\section{Standardisierung}
\subsection{Standardisierungskommision}
\subsubsection{International}
\slides{12-grundlagen_print}{7}
\subsubsection{National/Europäisch}
\slides{12-grundlagen_print}{8}
\subsection{Standards}
\slides{12-grundlagen_print}{9}

\section{OSI Modell}
\subsection*{ISO OSI 7-Schichtenprotokoll}
\slides{12-grundlagen_print}{10}
OSI: Open System Interconnection
\subsection*{Trennung in Anwendungs- und Transportverbindung}
\slides{12-grundlagen_print}{11}
\subsection{Bitübertragungsschicht (Physical Layer)}
\slides{12-grundlagen_print}{12}
\subsubsection*{Beispiel RS232}
\slides{12-grundlagen_print}{13}
\subsection{Sicherungsschicht (Data Link Layer)}
\slides{12-grundlagen_print}{14}
\subsection{Vermittlungsschicht (Network Layer)}
\slides{12-grundlagen_print}{15}
\subsection{Transportschicht (Transport Layer)}
\slides{12-grundlagen_print}{16}
\subsection{Sitzungsschicht (Session Layer)}
\slides{12-grundlagen_print}{17}
\subsection{Darstellungsschicht (Presentation Layer)}
\slides{12-grundlagen_print}{18}
\subsection{Anwendungsschicht (Application Layer)}
\slides{12-grundlagen_print}{19}

\section{Protokolle und Dienste}
\subsection{Protokolle}
\subsubsection{Protokollbegriff}
\slides{12-grundlagen_print}{20}
\subsubsection{Grundfunktionen in Protokollen}
\slides{12-grundlagen_print}{21}
\subsection{Dienste}
\slides{12-grundlagen_print}{22}
\subsubsection{Begriffe}
\slides{12-grundlagen_print}{23}
\subsection{Dienst und Protokoll}
\slides{12-grundlagen_print}{24}
\subsubsection*{Beispiel: Gespräch der Philosophen}
\slides{12-grundlagen_print}{25}
\begin{tabular}{c c c r}
Chinesischer Philosoph & $\overset{\text{Thema}}{\longleftrightarrow}$ & Spanischer Philosoph\\
$\downarrow$ &  &  $\downarrow$\\
Übersetzung Englisch & $\overset{\text{Englisch}}{\longleftrightarrow}$ & Übersetzung Englisch\\
$\downarrow$ & & $\downarrow$\\
Funker & $\overset{\text{Morse}}{\longleftrightarrow}$ & Funker
\end{tabular}\\
Veranschaulichung: Horizontal ist das Protokoll und vertikal der Dienst.
\subsubsection{Dienstelemente: Funktionsprinzip}
\slides{12-grundlagen_print}{26}
\subsubsection{Protokolldateneinheit / Interfacedateneinheit}
\slides{12-grundlagen_print}{27}
\subsubsection{Zusammenhang: SDU - PCI - PDU - IDU}
\slides{12-grundlagen_print}{28}
\subsubsection{Schichten und PDUs}
\slides{12-grundlagen_print}{29}
\subsubsection{Beispiel für Dienstelemente}
\slides{12-grundlagen_print}{30}
\subsubsection{Zeitdiagramm mit Dienstelementen}
Verbindungsaufbau zu Dienstelementen
\slides{12-grundlagen_print}{31}
\section{Protokollbeschreibungen}
(Möglichkeiten, vgl. Software Engineering)
\slides{12-grundlagen_print}{32}
\subsection{Systementwurf / Detailentwurf}
\slides{12-grundlagen_print}{33}
\subsubsection{TCP-Zustände des Servers}
\slides{12-grundlagen_print}{34}
\subsubsection{TCP-Zustandsmaschine}
\slides{12-grundlagen_print}{35}
\subsection{Zusammenfassung}
\slides{12-grundlagen_print}{36}
\subsubsection{Übung für Dienst-Primitiven (Operationen)}
\slides{12-grundlagen_print}{37}
\slides{12-grundlagen_print}{38}

\chapter{Transportschicht UDP/TCP}
\section{Aufgaben der Transportschicht}
\slides{15-transportschicht_print}{3}
\subsection{Transportschichten im Internet}
\slides{15-transportschicht_print}{4}
\subsection{Multiplexing / Demultiplexing}
\slides{15-transportschicht_print}{5}
\subsection{Verbindungsloses Multiplexing}
\slides{15-transportschicht_print}{6}
\section{UDP}
\subsection{UDP-Header}
(RFC 768)
\slides{15-transportschicht_print}{7}
\subsection{UDP-Lite}
(RFC 3828, UDP für geringe Verzögerungen $\to$ Mediendaten)
\slides{15-transportschicht_print}{8}

\subsection{Netzwerk-Datenformat}
\slides{15-transportschicht_print}{9}
\section{TCP}
\subsection{Verbindungsorientiertes Multiplexing}
\slides{15-transportschicht_print}{10}
\slides{15-transportschicht_print}{11}
\subsection{TCP-Nutzung}
\slides{15-transportschicht_print}{12}
\subsection{TCP-Eigenschaften}
\slides{15-transportschicht_print}{13}
\subsection{TCP-Header}
\slides{15-transportschicht_print}{14}
\slides{15-transportschicht_print}{15}

\subsection{TCP Verbindungsstart}
(Drei-Wege-Handshake)
\slides{15-transportschicht_print}{16}
\subsubsection{Sequenznummern}
\slides{15-transportschicht_print}{17}
\subsection{Freigabe von Verbindungen}
\slides{15-transportschicht_print}{18}
\subsubsection{Zwei-Armeen-Problem}
\slides{15-transportschicht_print}{19}

\subsection{TCP Verbindungsende}
\slides{15-transportschicht_print}{20}
\subsubsection{TCP Zustände des Servers}
\slides{15-transportschicht_print}{21}
\subsubsection{TCP Zustände des Clients}
\slides{15-transportschicht_print}{22}

\subsection{TCP Datenübertragung}
\slides{15-transportschicht_print}{23}
\subsubsection{Beispiel Datenübertragung}
\slides{15-transportschicht_print}{24}
\subsubsection{Beispiel Segmentverlust}
\slides{15-transportschicht_print}{25}
\subsubsection{Beispiel zu knapper Timeout}
\slides{15-transportschicht_print}{26}
\subsubsection{Beispiel Kumulative ACKs}
\slides{15-transportschicht_print}{27}

\subsubsection{Test TCP-Segmenterzeugung}
\slides{15-transportschicht_print}{28}
(potentielle Prüfungsaufgabe)

\subsection{TCP-ACK-Erzeugung}
(RFC 1122, RFC 2581)
\slides{15-transportschicht_print}{29}
\subsubsection{Beispiel TCP Fast Retransmit}
\slides{15-transportschicht_print}{30}

\subsection{TCP Flusskontrolle}
Angleichen der Sende-/Empfangsgeschwindigkeit
\slides{15-transportschicht_print}{31}
\subsubsection{TCP-RcvWindow}
\slides{15-transportschicht_print}{32}
\subsubsection{Beispiel TCP Verbindungsaufbau}
Paketsniffer Wireshark
\slides{15-transportschicht_print}{33}
\slides{15-transportschicht_print}{34}
\subsubsection{Retransmission-Timer}
\slides{15-transportschicht_print}{35}
\subsubsection*{RTT Bestimmung}
\slides{15-transportschicht_print}{36}
\subsubsection*{RTO Bestimmung}
\slides{15-transportschicht_print}{37}
Achtung: Startwerte und Minimum RTO sind hier sehr konservativ angegeben!\\
Hinweis: RTO Formel nützlich für Beleg. Startwerte kürzer setzen und Minimum nicht nötig.

\subsection{TCP Überlastkontrolle}
\slides{15-transportschicht_print}{38}
1. Bild: Flusskontrolle, 2. Bild: Überlastkontrolle\\
Daran stellt man Überlast fest:
\begin{itemize}
\item Paketverlust
\end{itemize}
\subsubsection{Ansätze zur Überlastkontrolle}
\slides{15-transportschicht_print}{39}
\subsubsection{Überlastkontrolle bei TCP}
\slides{15-transportschicht_print}{40}
\subsubsection{TCP Überlastkontrolle durch variable Fenstergröße}
Erhöhung der Fenstergröße bis Verlust eintritt
\slides{15-transportschicht_print}{41}
\subsubsection{TCP Slow Start}
\slides{15-transportschicht_print}{42}
\slides{15-transportschicht_print}{43}
\subsubsection{Fast Recovery}
\slides{15-transportschicht_print}{44}
\subsubsection{Optimale TCP Buffergröße}
Sende- und Empfangspuffer des Sockets
\slides{15-transportschicht_print}{45}
\subsubsection{Zusammenfassung TCP Überlastkontrolle}
\slides{15-transportschicht_print}{46}
\subsubsection{Verfahren zur Verstopfungsvermeidung}
Forschungsthema
\slides{15-transportschicht_print}{47}

\subsection{TCP Reset}
\slides{15-transportschicht_print}{48}
Verfahren beim Empfang in Abhängigkeit vom Zustand:
\slides{15-transportschicht_print}{49}

\subsection{Keepalive}
\slides{15-transportschicht_print}{50}

\section{Zusammenfassung Transportschicht}
\slides{15-transportschicht_print}{51}

\section{Ergänzungen}
\subsection{Erweiterung Zeitstempel}
\slides{15-transportschicht_print}{52}
\subsection{Wireshark}
Erkenntnisgewinn durch Paketanalyse
\slides{15-transportschicht_print}{53}
\subsection{TCP-Fairness}
\slides{15-transportschicht_print}{54}
\subsection{TCP offload engine (TOE)}
\slides{15-transportschicht_print}{55}
\subsection{TCP Zustandsmaschine}
\slides{15-transportschicht_print}{56}

\chapter{Sicherungsprotokolle}
\section{Überblick}
\subsection{FEC-Verfahren (Forward Error Correction)}
\slides{20-sicherungsprotokolle_print}{3}
Potentielle als Echtzeitanwendung.

\subsection{ARQ-Verfahren (Automatic Repeat Request)}
\slides{20-sicherungsprotokolle_print}{4}
Nicht gut für Echtzeitanwendungen, da Verzögerung.

\subsection{Hybride FEC/ARQ-Systeme}
\slides{20-sicherungsprotokolle_print}{5}

\subsection{Coderate}
\slides{20-sicherungsprotokolle_print}{6}

\subsection{Details zum ARQ-Verfahren}
\subsubsection{Fehlerereignisse}
\slides{20-sicherungsprotokolle_print}{7}
\subsubsection{Paketfehlerrate}
Bei der Paketfehlerrate muss berücksichtigt werden, wie oft das Paket erfolgreich als fehlerhaft erkannt wird und erneut gesendet wird:
\slides{20-sicherungsprotokolle_print}{8}
\subsubsection{Durchsatz}
\slides{20-sicherungsprotokolle_print}{9}
\subsubsection{Beispiel}
\slides{20-sicherungsprotokolle_print}{10}
D.h. maximal $84\%$ sind als Durchsatz zu erwarten!
\subsubsection{Unterteilung}
\slides{20-sicherungsprotokolle_print}{11}

\section{Stop-and-Wait}
\slides{20-sicherungsprotokolle_print}{12}
\subsection{Durchsatz}
\slides{20-sicherungsprotokolle_print}{13}
$T_W=2T_{AB}+T_{ACK}$
\subsection{Beispiel Satellitenkanal}
\slides{20-sicherungsprotokolle_print}{14}
Sehr ungünstig für Stop-and-Wait Protokoll, da das Verhältnis der Paketgröße zur Wartezeit zu ungünstig ist (zu kleine Pakete/zu lange Wartezeit) $\Rightarrow$ die Übertragungszeit ist zu lang.
\subsection{Beispiel Rechnernetz}
Abschätzung des Durchsatzes:
\slides{20-sicherungsprotokolle_print}{15}

\section{Go-Back-N-Protokoll (GBN)}
\slides{20-sicherungsprotokolle_print}{16}
\subsection{Optimale Fenstergröße}
\slides{20-sicherungsprotokolle_print}{17}
Hinweise Notation: $\lceil a \rceil \Rightarrow a$ wird aufgerundet 
\subsection{Sendefenster der Größe N}
\slides{20-sicherungsprotokolle_print}{18}
\subsection{Durchsatz}
\slides{20-sicherungsprotokolle_print}{19}
Ist zwar langsamer als folgendes (SR), dafür braucht Empfänger aber keinen Puffer!

\section{Selective Repeat-Protokoll (SR)}
\slides{20-sicherungsprotokolle_print}{20}
\subsection{Sendefenster}
\slides{20-sicherungsprotokolle_print}{21}
\subsection{Empfangsfenster}
\slides{20-sicherungsprotokolle_print}{22}
\subsection{Durchsatz}
\slides{20-sicherungsprotokolle_print}{23}

\section{Ergänzungen}
\subsection{Paketnummerierung}
\slides{20-sicherungsprotokolle_print}{24}
\subsection{Bidirektionale Datenübertragung}
\slides{20-sicherungsprotokolle_print}{25}
\subsection{Vergleich der Sicherungsprotokolle}
\slides{20-sicherungsprotokolle_print}{26}
\subsection{Beispiel mit verschiedenen ARQ-Protokollen}
(Richtfunkanlage)
\slides{20-sicherungsprotokolle_print}{27}
\subsection{Zusammenfassung}
\slides{20-sicherungsprotokolle_print}{28}
\subsection{Beleg Stop-and-Wait}
Zustände Sender:
\begin{itemize}
\item Wait for Data
\item Wait for ACK
\end{itemize}
Übergange:\\
Wait for Data $\to$ SW called send / send packet 0/1 $\to$ Wait for ACK\\
Wait for ACK $\to$ received ACK /  $\to$ Wait for Data\\
Wait for ACK $\to$ timeout / resend packet || stop $\to$ Wait for ACK \\
Wait for ACK $\to$ wrong ACK || wrong Session ID / $\to$ Wait for ACK

\chapter{Vermittlungsschicht}
\slides{24-vermittlung_print}{3}
\section{Leitungsvermittlung}
\slides{24-vermittlung_print}{4}
\slides{24-vermittlung_print}{5}
\section{Paketvermittlung}
\slides{24-vermittlung_print}{6}
\slides{24-vermittlung_print}{7}
\section{Mischformen}
Betriebsarten paketvermittelter Netze
\slides{24-vermittlung_print}{8}
\section{Zellvermittlung}
\slides{24-vermittlung_print}{9}
\section{Routing}
Vermittlungskonzepte
\slides{24-vermittlung_print}{10}
\subsection{Wegesuchung}
\slides{24-vermittlung_print}{11}
\subsection{Überlastungsprobleme}
\subsubsection{flow control}
\slides{24-vermittlung_print}{12}
\subsubsection{Verstopfungskontrolle}
(congestion control)
\slides{24-vermittlung_print}{13}
\subsection{Pufferspeicherverwaltung}
\slides{24-vermittlung_print}{14}

\section{Internetprotokoll}
\slides{25-ip-schicht_print}{3}
\subsection{Einführung}
\subsubsection{Aufgaben der IP-Schicht}
\slides{25-ip-schicht_print}{4}
\subsubsection{Vergleich OSI -- IP}
\slides{25-ip-schicht_print}{5}
\subsubsection{Internetadressen}
Drei unabhängige Namens-/Adressebenen
\slides{25-ip-schicht_print}{6}
\subsubsection{Domain Name System (DNS)}
\slides{25-ip-schicht_print}{7}

\subsubsection{IP-Vergabe}
\slides{25-ip-schicht_print}{8}

\subsubsection{Internetadressen (IPv4)}
\slides{25-ip-schicht_print}{9}
\subsection{Adressklassen}
(classfull addressing) Unterteilung in Netz und Host
\slides{25-ip-schicht_print}{10}

\subsubsection{Besondere Internet-Adressen}
\slides{25-ip-schicht_print}{11}
\subsubsection{Subnetting}
Aufteilung eines Netzes in mehrere Netze
\slides{25-ip-schicht_print}{12}
\subsection{Classless Interdomain Routing (CIDR)}
\slides{25-ip-schicht_print}{13}
\subsubsection*{Beispiel}
Vergabe von Adressen aus dem Pool eines Internet-Providers
\slides{25-ip-schicht_print}{14}
\slides{25-ip-schicht_print}{15}
\slides{25-ip-schicht_print}{16}
Hostadressen in einem /31 Netz: 0 (nur ein Bit für Adresse übrig: 0 steht für Netzadresse, 1 für Broadcastadresse $\to$ keine Hostadresse mehr übrig)\\
$\Rightarrow$ /30 Netz: 2 Hostadressen
\subsection{IP-Netz}
\subsubsection{Definition IP-Netz}
Hosts mit gleicher Netzadresse befinden sich im gleichen Netz
\slides{25-ip-schicht_print}{17}
\subsubsection{Adressarten}
\slides{25-ip-schicht_print}{18}
\subsubsection{Hardwareadressen}
\slides{25-ip-schicht_print}{19}
\subsubsection{Adress Resolution Protokoll}
Beispiel: A möchte HW-Adresse von B erhalten
\slides{25-ip-schicht_print}{20}
\subsubsection*{Anzeigen}
\slides{25-ip-schicht_print}{21}
\subsubsection{Übertragung eines Datagramms}
Übertragung 111.111.111.111 zu 222.222.222.222 (Maske 255.255.255.0)
\slides{25-ip-schicht_print}{22}








%\newpage
%\printbibliography

\end{document}